!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.nd=e():t.nd=e()}(this,(function(){return(()=>{"use strict";var t={607:function(t,e,a){var r=this&&this.__createBinding||(Object.create?function(t,e,a,r){void 0===r&&(r=a),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[a]}})}:function(t,e,a,r){void 0===r&&(r=a),t[r]=e[a]}),s=this&&this.__exportStar||function(t,e){for(var a in t)"default"===a||Object.prototype.hasOwnProperty.call(e,a)||r(e,t,a)};Object.defineProperty(e,"__esModule",{value:!0}),s(a(149),e)},192:(t,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.handler=e.softmax=e.tanh=e.binayStep=e.softplus=e.elu=e.leakyrelu=e.relu=e.sigmoid=e.linear=void 0;const r=a(198),s=a(712),i=a(274),n=a(374),o=a(512),h=a(10);e.linear={fn:t=>t,fnPrime:t=>(0,r.ones)(t.shape),updateError:t=>t,name:"linear"},e.sigmoid={fn:t=>(0,s.map)(t,(t=>1/(1+Math.exp(-t)))),fnPrime:t=>(0,s.map)(t,(t=>t*(1-t))),updateError:(t,e)=>(0,i.mult)(t,e),name:"sigmoid"},e.relu={fn:t=>(0,s.map)(t,(t=>Math.max(0,t))),fnPrime:t=>(0,s.map)(t,(t=>t>0?1:0)),updateError:(t,e)=>(0,i.mult)(t,e),name:"relu"},e.leakyrelu={fn:t=>(0,s.map)(t,(t=>Math.max(.05*t,t))),fnPrime:t=>(0,s.map)(t,(t=>t>0?1:.05)),updateError:(t,e)=>(0,i.mult)(t,e),name:"leakyrelu"},e.elu={fn:t=>(0,s.map)(t,(t=>t>0?t:.05*(Math.exp(t)-1))),fnPrime:t=>(0,s.map)(t,(t=>t>0?1:.05+t)),updateError:(t,e)=>(0,i.mult)(t,e),name:"elu"},e.softplus={fn:t=>(0,s.map)(t,(t=>Math.log(1+Math.exp(t)))),fnPrime:t=>(0,s.map)(t,(t=>1/(1+Math.exp(-t)))),updateError:(t,e)=>(0,i.mult)(t,e),name:"softplus"},e.binayStep={fn:t=>(0,s.map)(t,(t=>t>0?1:0)),fnPrime:t=>(0,s.map)(t,(()=>0)),updateError:(t,e)=>(0,i.mult)(t,e),name:"binaryStep"},e.tanh={fn:t=>(0,s.map)(t,(t=>Math.tanh(t))),fnPrime:t=>(0,s.map)(t,(t=>1-t**2)),updateError:(t,e)=>(0,i.mult)(t,e),name:"tanh"},e.softmax={fn:t=>{let e=(0,i.sub)(t,t.max());return(0,i.div)((0,s.exp)(e),(0,n.sumExp)(e))},fnPrime:t=>{let e=[];for(let a=0;a<t.shape[0];a++){e[a]=[];for(let r=0;r<t.shape[0];r++)e[a][r]=a==r?t.data[a]*(1-t.data[a]):-t.data[a]*t.data[r]}return new o.Tensor(e,[t.shape[0],t.shape[0]])},updateError:(t,e)=>(0,h.dot)(e,t),name:"softmax"},e.handler=t=>{switch(t){case"sigmoid":default:return e.sigmoid;case"relu":return e.relu;case"binaryStep":return e.binayStep;case"tanh":return e.tanh;case"softmax":return e.softmax;case"linear":return e.linear}}},149:function(t,e,a){var r=this&&this.__createBinding||(Object.create?function(t,e,a,r){void 0===r&&(r=a),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[a]}})}:function(t,e,a,r){void 0===r&&(r=a),t[r]=e[a]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__exportStar||function(t,e){for(var a in t)"default"===a||Object.prototype.hasOwnProperty.call(e,a)||r(e,t,a)},n=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)"default"!==a&&Object.prototype.hasOwnProperty.call(t,a)&&r(e,t,a);return s(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.util=e.activations=e.initializers=e.optimizers=e.losses=e.layer=void 0,i(a(617),e),e.layer=n(a(445)),e.losses=n(a(73)),e.optimizers=n(a(837)),e.initializers=n(a(414)),e.activations=n(a(192)),e.util=n(a(805)),i(a(186),e)},414:function(t,e,a){var r=this&&this.__createBinding||(Object.create?function(t,e,a,r){void 0===r&&(r=a),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[a]}})}:function(t,e,a,r){void 0===r&&(r=a),t[r]=e[a]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)"default"!==a&&Object.prototype.hasOwnProperty.call(t,a)&&r(e,t,a);return s(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.fromObject=e.handler=e.varianceScaling=e.heNormal=e.heUniform=e.xavierNormal=e.xavierUniform=e.randomNormal=e.randomUniform=e.zeros=e.ones=e.constant=e.Initializer=e.calculateFans=void 0;const n=a(198),o=i(a(805));e.calculateFans=t=>{t.map((t=>Math.floor(t)));let e=1,a=1;if(2==t.length)e=t[1],a=t[0];else if(4==t.length){let r=t[2]*t[3];e=r*t[1],a=r*t[0]}return[e,a]};class h{constructor(t,e,a){this.func=t,this.name=e,this.args=a}apply(t){let a=1,r=[];this.args.InOutfans=(0,e.calculateFans)(t);for(let e=0;e<t.length;e++)a*=t[e];for(let t=0;t<a;t++)r[t]=this.func(this.args);return(0,n.fromVector)(r,t)}copy(){return JSON.parse(JSON.stringify(this))}}e.Initializer=h,e.constant=(t={})=>new h(((t={})=>t.value||0),"constant",t),e.ones=(t={})=>new h((()=>1),"ones",t),e.zeros=(t={})=>new h((()=>0),"zeros",t),e.randomUniform=(t={})=>new h(((t={})=>{let e=t.InOutfans[0]||1;e=1/Math.sqrt(e);let a=t.min||-e,r=t.max||e;return o.randomRange(a,r)}),"randomUniform",t),e.randomNormal=(t={})=>new h(((t={})=>{let e=t.mean||0,a=t.stddev||1;return o.randomNormal(e,a)}),"randomNormal",t),e.xavierUniform=(t={})=>new h(((t={})=>{let e=t.InOutfans[0]||1,a=t.InOutfans[1]||1,r=Math.sqrt(6)/Math.sqrt(e+a);return o.randomRange(-r,r)}),"xavierUniform",t),e.xavierNormal=(t={})=>new h(((t={})=>{let e=t.InOutfans[0]||1,a=t.InOutfans[1]||1,r=Math.sqrt(2/(e+a));return o.randomNormal(0,r)}),"xavierNormal",t),e.heUniform=(t={})=>new h(((t={})=>{let e=t.InOutfans[0]||1,a=Math.sqrt(6/e);return o.randomRange(-a,a)}),"heUniform",t),e.heNormal=(t={})=>new h(((t={})=>{let e=t.InOutfans[0]||1,a=Math.sqrt(2/e);return o.randomNormal(0,a)}),"heNormal",t),e.varianceScaling=(t={})=>new h(((t={})=>{let e=t.InOutfans[0]||1,a=t.InOutfans[1]||1,r=t.scale||1,s=e;if("fan_out"==t.mode?s=a:"avg"==t.mode&&(s=(e+a)/2),"uniform"==t.distribution){let t=Math.sqrt(3*r/s);return o.randomRange(-t,t)}{let t=Math.sqrt(r/s);return o.randomNormal(0,t)}}),"varianceScaling",t),e.handler=t=>{switch(t){case"constant":return e.constant;case"ones":return e.ones;case"zeros":return e.zeros;case"randomUniform":default:return e.randomUniform;case"randomNormal":return e.randomNormal;case"xavierUniform":return e.xavierUniform;case"xavierNormal":return e.xavierNormal;case"heUniform":return e.heUniform;case"heNormal":return e.heNormal;case"varianceScaling":return e.varianceScaling}},e.fromObject=t=>{switch(t.name){case"constant":return(0,e.constant)(t.args);case"ones":return(0,e.ones)(t.args);case"zeros":return(0,e.zeros)(t.args);case"randomUniform":return(0,e.randomUniform)(t.args);case"randomNormal":return(0,e.randomNormal)(t.args);case"xavierUniform":return(0,e.xavierUniform)(t.args);case"xavierNormal":return(0,e.xavierNormal)(t.args);case"heUniform":return(0,e.heUniform)(t.args);case"heNormal":return(0,e.heNormal)(t.args);case"varianceScaling":return(0,e.varianceScaling)(t.args);default:return(0,e.randomUniform)()}}},17:(t,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ActivationClass=void 0;const r=a(512),s=a(101);class i extends s.Layer{constructor(t){super(),this.isTrainable=!1,this.type="activation",this.name=t.name,this.fn=t.fn,this.fnPrime=t.fnPrime,this.updateError=t.updateError,this.inputShape=0,this.outputShape=this.inputShape,this.forwardedInput=new r.Tensor([])}resize(t){this.inputShape=t,this.outputShape=this.inputShape}forward(t){return this.input=t,this.forwardedInput=this.fn(t),this.forwardedInput}backward(t){return this.updateError(t,this.fnPrime(this.forwardedInput))}serialize(){return JSON.stringify(this)}}e.ActivationClass=i},624:function(t,e,a){var r=this&&this.__createBinding||(Object.create?function(t,e,a,r){void 0===r&&(r=a),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[a]}})}:function(t,e,a,r){void 0===r&&(r=a),t[r]=e[a]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)"default"!==a&&Object.prototype.hasOwnProperty.call(t,a)&&r(e,t,a);return s(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.ConvClass=void 0;const n=a(512),o=a(470),h=a(198),l=a(274),u=a(101),p=i(a(192)),f=i(a(414));class d extends u.TrainableLayer{constructor(t){super(),"string"==typeof t.activation&&(this.activation=t.activation,this.activationFunction=p.handler(this.activation)),this.type="conv",this.name=this.type,this.isTrainable=!0,this.filters=Math.floor(t.filters),this.padding=t.padding||"valid",t.weightsConstrain&&(this.weightsConstrain=t.weightsConstrain),t.biasConstrain&&(this.biasConstrain=t.biasConstrain),this.kernelInitializer=f.xavierNormal(),t.kernelInitializer instanceof f.Initializer?this.kernelInitializer=t.kernelInitializer:"string"==typeof t.kernelInitializer&&(this.kernelInitializer=f.handler(t.kernelInitializer)()),this.biasInitializer=f.zeros(),t.biasInitializer instanceof f.Initializer?this.biasInitializer=t.biasInitializer:"string"==typeof t.biasInitializer&&(this.biasInitializer=f.handler(t.biasInitializer)()),this.kernelSize="number"==typeof t.kernelSize?this.kernelSize=[t.kernelSize,t.kernelSize]:[t.kernelSize[0],t.kernelSize[1]],this.kernelSize.map((t=>Math.floor(t))),this.stride=[1,1],t.stride&&(this.stride=t.stride instanceof Array?t.stride:[t.stride,t.stride],this.stride.map((t=>Math.floor(t)))),this.dilation=[1,1],t.dilation&&(this.dilation=t.dilation instanceof Array?t.dilation:[t.dilation,t.dilation],this.dilation.map((t=>Math.floor(t)))),this.kernelGradientPad="valid",this.inputGradientPad="full","same"==this.padding&&(this.kernelGradientPad=[this.kernelSize[0]-1,this.kernelSize[1]-1],this.inputGradientPad="same"),this.inputShape=t.inputShape?t.inputShape.slice():[1,1,1],this.inputShape.map((t=>Math.floor(t))),this.kernelShape=[this.filters,this.inputShape[0],this.kernelSize[0],this.kernelSize[1]],this.padAmt=(0,o.c_c_paddAmount)(this.inputShape,this.kernelShape,this.padding,this.stride,this.dilation),this.outputShape=(0,o.cc_manyFilters_outputShape)(this.inputShape,this.kernelShape,this.padAmt,this.stride,this.dilation),this.weights=this.kernelInitializer.apply(this.kernelShape),this.bias=this.biasInitializer.apply(this.outputShape),this.weightsGradient=(0,h.zeros)(this.weights.shape),this.biasGradient=(0,h.zeros)(this.bias.shape),this.optimizerWeights=[this.weightsGradient,(0,h.zeros)(this.weights.shape),(0,h.zeros)(this.weights.shape)],this.optimizerBias=[this.biasGradient,(0,h.zeros)(this.bias.shape),(0,h.zeros)(this.bias.shape)],this.parameters=this.weights.size()+this.bias.size(),void 0!==t.weights&&this.setParameters(t)}resize(t){this.inputShape=t instanceof Array?t:[1,1,1],this.inputShape.map((t=>Math.floor(t))),this.kernelShape=[this.filters,this.inputShape[0],this.kernelSize[0],this.kernelSize[1]],this.padAmt=(0,o.c_c_paddAmount)(this.inputShape,this.kernelShape,this.padding,this.stride,this.dilation),this.outputShape=(0,o.cc_manyFilters_outputShape)(this.inputShape,this.kernelShape,this.padAmt,this.stride,this.dilation),this.weights=this.kernelInitializer.apply(this.kernelShape),this.bias=this.biasInitializer.apply(this.outputShape),this.weightsGradient=(0,h.zeros)(this.weights.shape),this.biasGradient=(0,h.zeros)(this.bias.shape),this.optimizerWeights=[this.weightsGradient,(0,h.zeros)(this.weights.shape),(0,h.zeros)(this.weights.shape)],this.optimizerBias=[this.biasGradient,(0,h.zeros)(this.bias.shape),(0,h.zeros)(this.bias.shape)],this.parameters=this.weights.size()+this.bias.size()}forward(t){this.input=t;let e=(0,o.corr_manyFilters_addB)(this.input,this.weights,this.bias,this.padding,this.stride,this.dilation);return void 0!==this.activation?(this.output=this.activationFunction.fn(e),this.output):e}backward(t){let e;e=null==this.activation?t:this.activationFunction.updateError(t,this.activationFunction.fnPrime(this.output));let a=[],r=(0,h.zeros)(this.inputShape);for(let t=0;t<this.kernelShape[0];t++){a[t]=[];for(let s=0;s<this.kernelShape[1];s++){a[t][s]=(0,o.correlate)(this.input.data[s],e.data[t],this.kernelGradientPad).data;let i=(0,o.convolution)(e.data[t],this.weights.data[t][s],this.inputGradientPad);r.data[s]=(0,l.add)(r.data[s],i).data}}return a=new n.Tensor(a,this.kernelShape),this.weightsGradient.add(a),this.biasGradient.add(e),r}}e.ConvClass=d},97:function(t,e,a){var r=this&&this.__createBinding||(Object.create?function(t,e,a,r){void 0===r&&(r=a),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[a]}})}:function(t,e,a,r){void 0===r&&(r=a),t[r]=e[a]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)"default"!==a&&Object.prototype.hasOwnProperty.call(t,a)&&r(e,t,a);return s(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.DenseClass=void 0;const n=a(198),o=a(10),h=a(101),l=i(a(192)),u=i(a(414));class p extends h.TrainableLayer{constructor(t){super(),this.type="dense","string"==typeof t.activation&&(this.activation=t.activation,this.activationFunction=l.handler(this.activation)),this.isTrainable=!0,this.units=Math.floor(t.units),this.outputShape=this.units,this.kernelInitializer=u.xavierNormal(),t.kernelInitializer instanceof u.Initializer?this.kernelInitializer=t.kernelInitializer:"string"==typeof t.kernelInitializer&&(this.kernelInitializer=u.handler(t.kernelInitializer)()),this.biasInitializer=u.zeros(),t.biasInitializer instanceof u.Initializer?this.biasInitializer=t.biasInitializer:"string"==typeof t.biasInitializer&&(this.biasInitializer=u.handler(t.biasInitializer)()),this.inputShape=t.inputShape?Math.floor(t.inputShape):1,this.weights=this.kernelInitializer.apply([this.units,this.inputShape]),this.bias=this.biasInitializer.apply([this.units]),this.weightsConstrain=t.weightsConstrain||[-1e7,1e7],this.biasConstrain=t.biasConstrain||[-1e7,1e7],this.weightsGradient=(0,n.zeros)(this.weights.shape),this.biasGradient=(0,n.zeros)(this.bias.shape),this.optimizerWeights=[this.weightsGradient,(0,n.zeros)(this.weights.shape),(0,n.zeros)(this.weights.shape)],this.optimizerBias=[this.biasGradient,(0,n.zeros)(this.bias.shape),(0,n.zeros)(this.bias.shape)],this.parameters=this.units*this.inputShape+this.outputShape,void 0!==t.weights&&this.setParameters(t)}resize(t){this.inputShape=t instanceof Array?t[0]:t,this.weights=this.kernelInitializer.apply([this.units,this.inputShape]),this.bias=this.biasInitializer.apply([this.units]),this.reshapeOptimizerParameters(),this.parameters=this.units*this.inputShape+this.outputShape}forward(t){this.input=t;let e=(0,o.dot)(this.weights,this.input).add(this.bias);return void 0!==this.activation?(this.output=this.activationFunction.fn(e),this.output):e}backward(t){let e;e=null==this.activation?t:this.activationFunction.updateError(t,this.activationFunction.fnPrime(this.output));let a=(0,o.transpose)(this.input),r=(0,o.dot)(e,a),s=e;this.weightsGradient.add(r),this.biasGradient.add(s);let i=(0,o.transpose)(this.weights);return(0,o.dot)(i,e)}}e.DenseClass=p},878:(t,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DropoutClass=void 0;const r=a(512),s=a(865),i=a(101);class n extends i.Layer{constructor(t={}){super(),this.type="dropout",this.rate=t.rate||.1,this.inputShape=t.inputShape?t.inputShape:1,this.outputShape=this.inputShape}resize(t){this.inputShape=t,this.outputShape=this.inputShape}forward(t){this.input=t;let e=(0,s.forEachReturn)(this.input.data,(t=>Math.random()<this.rate?0:t));return new r.Tensor(e,this.input.shape)}backward(t){return t}serialize(){return JSON.stringify(this)}}e.DropoutClass=n},818:(t,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FlattenCLass=void 0;const r=a(512),s=a(101);class i extends s.Layer{constructor(t={}){super(),this.type="flatten",this.inputShape=t.inputShape instanceof Array?t.inputShape.slice():[1,1,1],this.inputShape.map((t=>Math.floor(t))),this.outputShape=1;for(let t=0;t<this.inputShape.length;t++)this.outputShape*=this.inputShape[t]}resize(t){this.inputShape=t instanceof Array?t.slice():[1,1,1],this.inputShape.map((t=>Math.floor(t))),this.outputShape=1;for(let t=0;t<this.inputShape.length;t++)this.outputShape*=this.inputShape[t]}forward(t){this.input=t;let e=[];return this.input.forEach((t=>(e.push(t),t))),new r.Tensor(e,[this.outputShape])}backward(t){let e=[],a=0;for(let r=0;r<this.inputShape[0];r++){e[r]=[];for(let s=0;s<this.inputShape[1];s++){e[r][s]=[];for(let i=0;i<this.inputShape[2];i++)e[r][s][i]=t.data[a],a++}}return new r.Tensor(e,this.inputShape)}serialize(){return JSON.stringify(this)}}e.FlattenCLass=i},101:function(t,e,a){var r=this&&this.__createBinding||(Object.create?function(t,e,a,r){void 0===r&&(r=a),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[a]}})}:function(t,e,a,r){void 0===r&&(r=a),t[r]=e[a]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)"default"!==a&&Object.prototype.hasOwnProperty.call(t,a)&&r(e,t,a);return s(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.TrainableLayer=e.Layer=void 0;const n=i(a(192)),o=a(512),h=a(928),l=a(198),u=a(805),p=i(a(414));class f{constructor(){this.input=new o.Tensor([]),this.type="",this.name="",this.isTrainable=!1}forward(t){return(0,h.ensureTensor)(t)}backward(t,e=1){return t.mult(e)}serialize(){return JSON.stringify(this)}}e.Layer=f,e.TrainableLayer=class extends f{constructor(){super(),this.output=new o.Tensor([]),this.name=this.type,this.activation=void 0,this.activationFunction=n.linear,this.weights=new o.Tensor([]),this.bias=new o.Tensor([]),this.weightsConstrain=[-1e7,1e7],this.biasConstrain=[-1e7,1e7],this.weightsGradient=new o.Tensor([]),this.biasGradient=new o.Tensor([]),this.optimizerWeights=[this.weightsGradient],this.optimizerBias=[this.weightsGradient],this.kernelInitializer=p.randomUniform(),this.biasInitializer=p.zeros(),this.parameters=0}reshapeOptimizerParameters(){this.weightsGradient=(0,l.zeros)(this.weights.shape),this.biasGradient=(0,l.zeros)(this.bias.shape),this.optimizerWeights=[this.weightsGradient,(0,l.zeros)(this.weights.shape),(0,l.zeros)(this.weights.shape)],this.optimizerBias=[this.biasGradient,(0,l.zeros)(this.bias.shape),(0,l.zeros)(this.bias.shape)]}update(t,e=1,a=0){this.weightsGradient.divNoNan(e),this.biasGradient.divNoNan(e),t.apply(this.weights,this.optimizerWeights,a),t.apply(this.bias,this.optimizerBias,a),this.weights.constrain(this.weightsConstrain),this.bias.constrain(this.biasConstrain),this.weightsGradient.mult(0),this.biasGradient.mult(0)}setParameters(t){this.setWeights((0,l.fromObject)(t.weights)),this.setBias((0,l.fromObject)(t.bias)),this.kernelInitializer=p.fromObject(t.kernelInitializer),this.biasInitializer=p.fromObject(t.biasInitializer);for(let e=1;e<t.optimizerWeights.length;e++)this.optimizerWeights[e]=(0,h.copy)((0,l.fromObject)(t.optimizerWeights[e])),this.optimizerBias[e]=(0,h.copy)((0,l.fromObject)(t.optimizerBias[e]))}setWeights(t){let e=(0,h.copy)(t);if(!(0,h.shapesEqual)(e.shape,this.weights.shape))throw"Weights shapes don't match";this.weights=e}getWeights(){return this.weights.copy()}setBias(t){let e=(0,h.copy)(t);if(!(0,h.shapesEqual)(e.shape,this.bias.shape))throw"Bias shapes don't match";this.bias=e}getBias(){return this.bias.copy()}mutate(t=.1,e){this.weights.map((a=>Math.random()<t?(0,u.randomRange)(e):a)),this.bias.map((a=>Math.random()<t?(0,u.randomRange)(e):a))}mutateWeights(t,e){this.weights.map((a=>Math.random()<t?(0,u.randomRange)(e):a))}mutateBias(t,e){this.bias.map((a=>Math.random()<t?(0,u.randomRange)(e):a))}}},445:function(t,e,a){var r=this&&this.__createBinding||(Object.create?function(t,e,a,r){void 0===r&&(r=a),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[a]}})}:function(t,e,a,r){void 0===r&&(r=a),t[r]=e[a]}),s=this&&this.__exportStar||function(t,e){for(var a in t)"default"===a||Object.prototype.hasOwnProperty.call(e,a)||r(e,t,a)};Object.defineProperty(e,"__esModule",{value:!0}),s(a(101),e),s(a(810),e),s(a(17),e)},810:function(t,e,a){var r=this&&this.__createBinding||(Object.create?function(t,e,a,r){void 0===r&&(r=a),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[a]}})}:function(t,e,a,r){void 0===r&&(r=a),t[r]=e[a]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)"default"!==a&&Object.prototype.hasOwnProperty.call(t,a)&&r(e,t,a);return s(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.activation=e.dropout=e.flatten=e.norm=e.maxPooling=e.conv=e.dense=e.fromObject=e.handler=void 0;const n=a(97),o=a(624),h=a(726),l=a(818),u=a(878),p=a(485),f=a(17),d=i(a(192));e.handler=t=>{switch(t){case"dense":default:return n.DenseClass;case"conv":return o.ConvClass;case"maxpooling":return h.MaxPoolingClass;case"flatten":return l.FlattenCLass;case"dropout":return u.DropoutClass;case"norm":return p.NormClass;case"activation":return f.ActivationClass}},e.fromObject=t=>new((0,e.handler)(t.type))(t),e.dense=t=>new n.DenseClass(t),e.conv=t=>new o.ConvClass(t),e.maxPooling=t=>new h.MaxPoolingClass(t),e.norm=t=>new p.NormClass(t),e.flatten=t=>new l.FlattenCLass(t),e.dropout=t=>new u.DropoutClass(t),e.activation=t=>{switch(t){case"sigmoid":default:return new f.ActivationClass(d.sigmoid);case"relu":return new f.ActivationClass(d.relu);case"binaryStep":return new f.ActivationClass(d.binayStep);case"tanh":return new f.ActivationClass(d.tanh);case"softmax":return new f.ActivationClass(d.softmax)}}},726:(t,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MaxPoolingClass=void 0;const r=a(198),s=a(470),i=a(101);class n extends i.Layer{constructor(t={}){super(),this.type="maxpooling",this.poolSize=[2,2],t.poolSize&&(this.poolSize=t.poolSize instanceof Array?t.poolSize:[t.poolSize,t.poolSize],this.poolSize.map((t=>Math.floor(t)))),this.stride=this.poolSize,t.stride&&(this.stride=t.stride instanceof Array?t.stride:[t.stride,t.stride],this.stride.map((t=>Math.floor(t)))),this.padding=t.padding||!1,this.inputShape=t.inputShape?t.inputShape.slice():[1,1,1],this.inputShape.map((t=>Math.floor(t))),this.padAmt=(0,s.mp_paddAmount)(this.inputShape,this.padding,this.poolSize,this.stride),this.outputShape=(0,s.mp_v_outputShape)(this.inputShape,this.padAmt,this.poolSize,this.stride),this.coords=t.coords?t.coords.slice():[]}resize(t){this.inputShape=t instanceof Array?t.slice():[1,1,1],this.inputShape.map((t=>Math.floor(t))),this.padAmt=(0,s.mp_paddAmount)(this.inputShape,this.padding,this.poolSize,this.stride),this.outputShape=(0,s.mp_v_outputShape)(this.inputShape,this.padAmt,this.poolSize,this.stride)}forward(t){return this.input=t,(0,s.maxPoolingVolume)(this.input,this.padding,this.poolSize,this.stride,this.coords)}backward(t){let e=(0,r.zeros)(this.inputShape);for(let a=0;a<this.coords.length;a++)e.data[this.coords[a][0]][this.coords[a][1]][this.coords[a][2]]=t.data[this.coords[a][0]][this.coords[a][3]][this.coords[a][4]];return e}}e.MaxPoolingClass=n},485:function(t,e,a){var r=this&&this.__createBinding||(Object.create?function(t,e,a,r){void 0===r&&(r=a),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[a]}})}:function(t,e,a,r){void 0===r&&(r=a),t[r]=e[a]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)"default"!==a&&Object.prototype.hasOwnProperty.call(t,a)&&r(e,t,a);return s(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.NormClass=void 0;const n=a(101),o=a(512),h=a(274),l=a(712),u=i(a(414)),p=i(a(192));class f extends n.TrainableLayer{constructor(t={}){super(),this.type="norm",this.isTrainable=!0,this.inputShape=1,t.inputShape instanceof Array&&(this.inputShape=t.inputShape.slice().map((t=>Math.floor(t)))),"number"==typeof t.inputShape&&(this.inputShape=Math.floor(t.inputShape)),this.outputShape=this.inputShape,this.internInputShape=this.inputShape instanceof Array?this.inputShape.slice().map((t=>Math.floor(t))):[Math.floor(this.inputShape)],this.kernelInitializer=u.ones(),t.kernelInitializer instanceof u.Initializer?this.kernelInitializer=t.kernelInitializer:"string"==typeof t.kernelInitializer&&(this.kernelInitializer=u.handler(t.kernelInitializer)()),this.biasInitializer=u.zeros(),t.biasInitializer instanceof u.Initializer?this.biasInitializer=t.biasInitializer:"string"==typeof t.biasInitializer&&(this.biasInitializer=u.handler(t.biasInitializer)()),this.weights=this.kernelInitializer.apply(this.internInputShape),this.bias=this.biasInitializer.apply(this.internInputShape),this.reshapeOptimizerParameters(),this.norm=new o.Tensor([]),this.xmu=new o.Tensor([]),this.variance=0,this.activation="linear","string"==typeof t.activation&&(this.activation=t.activation,this.activationFunction=p.handler(this.activation)),void 0!==t.weights&&this.setParameters(t)}resize(t){this.inputShape=t instanceof Array?t.slice().map((t=>Math.floor(t))):Math.floor(t),this.outputShape=this.inputShape,this.internInputShape=t instanceof Array?t.slice().map((t=>Math.floor(t))):[Math.floor(t)],this.weights=this.kernelInitializer.apply(this.internInputShape),this.bias=this.biasInitializer.apply(this.internInputShape),this.reshapeOptimizerParameters(),this.parameters=this.weights.size()+this.bias.size()}forward(t){this.input=t,this.xmu=(0,h.sub)(this.input,this.input.mean()),this.variance=(0,l.varianceSquared)(this.input)+1e-7,this.norm=(0,h.divNoNan)(this.xmu,this.variance**.5);let e=(0,h.mult)(this.weights,this.norm).add(this.bias);return this.output=this.activationFunction.fn(e),this.output}backward(t,e){let a=this.activationFunction.updateError(t,this.activationFunction.fnPrime(this.output)),r=(0,h.mult)(a,this.norm);this.weightsGradient.add(r),this.biasGradient.add(a);let s=1/this.variance**.5,i=(0,h.mult)(a,this.weights),n=(0,h.mult)(i,this.xmu).mult(-.5).mult(this.variance**-1.5),o=(0,h.mult)(i,-s).add((0,h.mult)(n,(0,h.divNoNan)(1/e,(0,h.mult)(this.xmu,-2))));return i=(0,h.mult)(i,s).add((0,h.add)((0,h.divNoNan)(o,e),(0,h.divNoNan)((0,h.mult)(n,2/e),this.xmu))),i}}e.NormClass=f},73:(t,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.binaryCrossEntropy=e.softmaxCrossEntropy=e.crossEntropy=e.meanSquaredError=e.handler=e.Loss=void 0;const r=a(274),s=a(374),i=a(712),n=a(928);class o{constructor(t){this.fn=t.fn,this.fnPrime=t.fnPrime,this.type="loss",this.name=t.name}serialize(){return JSON.stringify(this)}}e.Loss=o,e.handler=t=>{switch(t){case"mse":default:return e.meanSquaredError;case"crossEntropy":return e.crossEntropy;case"softmaxCrossEntropy":return e.softmaxCrossEntropy;case"binaryCrossEntropy":return e.binaryCrossEntropy}},e.meanSquaredError=new o({fn:(t,e)=>(0,r.sqd)(e,t).mean(),fnPrime:(t,e)=>(0,r.sub)(t,e).mult(2).div((0,n.size)(t)),name:"mse"}),e.crossEntropy=new o({fn:(t,e)=>-(0,r.mult)(e,(0,i.log)(t)).sum(),fnPrime:(t,e)=>(0,r.mult)(e,(0,r.divNoNan)(-1,t)),name:"crossEntropy"}),e.softmaxCrossEntropy=new o({fn:(t,e)=>{let a=(0,r.sub)(t,(0,s.max)(t)),n=(0,r.div)((0,i.exp)(a),(0,s.sumExp)(a));return-(0,r.mult)(e,(0,i.log)(n)).sum()},fnPrime:(t,e)=>{let a=(0,r.sub)(t,(0,s.max)(t)),n=(0,r.divNoNan)((0,i.exp)(a),(0,s.sumExp)(a));return(0,r.sub)(n,e)},name:"softmaxCrossEntropy"}),e.binaryCrossEntropy=new o({fn:(t,e)=>{let a=(0,r.mult)(e,(0,i.log)(t)),s=(0,r.sub)(1,e),n=(0,i.log)((0,r.sub)(1,t));return-(0,r.add)(a,(0,r.mult)(s,n)).mean()},fnPrime:(t,e)=>{let a=(0,r.divNoNan)((0,r.sub)(1,e),(0,r.sub)(1,t)),s=(0,r.divNoNan)(e,t),i=(0,r.sub)(a,s);return(0,r.divNoNan)(i,(0,n.size)(i))},name:"binaryCrossEntropy"})},186:function(t,e,a){var r=this&&this.__createBinding||(Object.create?function(t,e,a,r){void 0===r&&(r=a),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[a]}})}:function(t,e,a,r){void 0===r&&(r=a),t[r]=e[a]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)"default"!==a&&Object.prototype.hasOwnProperty.call(t,a)&&r(e,t,a);return s(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.NeuralNet=void 0;const n=i(a(73)),o=a(928),h=i(a(837)),l=a(97),u=a(624),p=i(a(810)),f=a(485);class d{constructor(){this.trainDataSize=0,this.batch=0,this.parameters=0,this.layers=[],this.numLayers=0,this.loss="mse",this.lossFunction=n.handler(this.loss),this.trainableLayers=[],this.error=1,this.optimizer=h.sgd(.1),this.batchSize=0}setLossFunction(t){this.loss=t,this.lossFunction=n.handler(this.loss)}compile(t){this.optimizer=t.optimizer||h.sgd(.1),"string"==typeof t.loss?(this.loss=t.loss,this.lossFunction=n.handler(this.loss)):(this.lossFunction=t.loss||n.meanSquaredError,this.loss=this.lossFunction.name)}add(t,e=!1){if(this.numLayers>0&&0==e){let e=this.layers[this.numLayers-1].outputShape;t.resize(e)}(t instanceof l.DenseClass||t instanceof u.ConvClass||t instanceof f.NormClass)&&(this.trainableLayers.push(t),this.parameters+=t.parameters),this.layers.push(t),this.numLayers++}predict(t){let e=(0,o.ensureTensor)(t);for(let t=0;t<this.numLayers;t++)e=this.layers[t].forward(e);return e}train(t,e,a={epochs:1,batchSize:1,shuffle:!1,trainDataSize:1}){let r=a.epochs||1,s=a.shuffle||!1;this.batchSize=a.batchSize||1,this.trainDataSize=a.trainDataSize||t.length;for(let a=0;a<r;a++)for(let a=0;a<t.length/this.batchSize;a++){this.error=0;let r=t.slice(a,a+this.batchSize),i=e.slice(a,a+this.batchSize);s&&(0,o.shuffleMatch)(r,i);for(let t=0;t<this.batchSize;t++){let e=this.predict(r[t]);this.error+=this.lossFunction.fn(e,i[t]);let a=this.lossFunction.fnPrime(e,i[t]);for(let t=this.numLayers-1;t>=0;t--)a=this.layers[t].backward(a,this.batchSize)}this.batch++,this.error/=this.batchSize,this.update(this.batch)}this.batch>this.trainDataSize/this.batchSize&&(this.batch=0)}update(t){for(let e=0;e<this.trainableLayers.length;e++)this.trainableLayers[e].update(this.optimizer,this.batchSize,t)}static fromObject(t){let e=new d;for(let a=0;a<t.layers.length;a++){let r;"activation"==t.layers[a].type?(r=p.activation(t.layers[a].name),e.add(r)):(r=p.fromObject(t.layers[a]),e.add(r,!0))}return e.trainDataSize=t.trainDataSize,e.batch=e.batch,e.loss=t.loss,e.lossFunction=n.handler(e.loss),e.error=t.error,e.optimizer=h.fromObject(t.optimizer),e}copy(){return d.fromObject(JSON.parse(JSON.stringify(this)))}static copy(t){return d.fromObject(JSON.parse(JSON.stringify(t)))}mutateRandomLayer(t=!1,e=.1,a=.1){let r=Math.floor(Math.random()*this.trainableLayers.length);this.trainableLayers[r].weights.forEach((t=>Math.random()<e?t+(2*Math.random()*a-a):t)),0!=t&&this.trainableLayers[r].bias.forEach((t=>Math.random()<e?t+(2*Math.random()*a-a):t))}mutate(t=!1,e=.1,a=.5){for(let r=0;r<this.trainableLayers.length;r++)this.trainableLayers[r].weights.forEach((t=>Math.random()<e?t+(2*Math.random()*a-a):t)),0!=t&&this.trainableLayers[r].bias.forEach((t=>Math.random()<e?t+(2*Math.random()*a-a):t))}serialize(){return JSON.stringify(this)}}e.NeuralNet=d},837:(t,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.fromObject=e.adam=e.rmsprop=e.momentum=e.sgd=e.Optimizer=void 0;const r=a(274),s=a(712);class i{constructor(t,e,a){this.apply=t,this.name=e,this.optParams=a}}e.Optimizer=i,e.sgd=(t=.1)=>new i(((e,a)=>{e.sub((0,r.mult)(a[0],t))}),"sgd",[t]),e.momentum=(t=.1,e=.9)=>new i(((a,s)=>{null==s[1]&&a.sub((0,r.mult)((0,r.mult)(s[0],1-e),t)),s[1]=(0,r.mult)(s[1],e).add((0,r.mult)(s[0],1-e)),a.sub((0,r.mult)(s[1],t))}),"momentum",[t,e]),e.rmsprop=(t=.01,e=.9,a=1e-7)=>new i(((i,n)=>{if(null==n[1]){let o=(0,r.mult)((0,s.square)(n[0]),1-e);i.sub((0,r.mult)((0,r.divNoNan)(n[0],(0,r.add)(o,a).sqrt()),t))}else n[1]=(0,r.mult)(n[1],e).add((0,r.mult)((0,s.square)(n[0]),1-e)),i.sub((0,r.mult)((0,r.divNoNan)(n[0],(0,r.add)(n[1],a).sqrt()),t))}),"rmsprop",[t,e,a]),e.adam=(t=.1,e=.9,a=.999,n=1e-7)=>new i(((i,o,h=0)=>{if(null==o[1]){let h=(0,r.mult)(o[0],1-e),l=(0,r.mult)((0,s.square)(o[0]),1-a),u=(0,r.divNoNan)(h,1-e),p=(0,r.divNoNan)(l,1-a);i.sub((0,r.mult)((0,r.divNoNan)(u,(0,r.add)(p,n).sqrt()),t))}else{o[1]=(0,r.mult)(o[1],e).add((0,r.mult)(o[0],1-e)),o[2]=(0,r.mult)(o[2],a).add((0,r.mult)((0,s.square)(o[0]),1-a));let l=(0,r.divNoNan)(o[1],1-e**h),u=(0,r.divNoNan)(o[2],1-a**h);i.sub((0,r.mult)((0,r.divNoNan)(l,(0,r.add)(u,n).sqrt()),t))}}),"adam",[t,e,a,n]),e.fromObject=t=>{switch(t.name){case"sgd":return(0,e.sgd)(t.optParams[0]);case"momentum":return(0,e.momentum)(t.optParams[0],t.optParams[1]);case"rmsprop":return(0,e.rmsprop)(t.optParams[0],t.optParams[1],t.optParams[2]);case"adam":return(0,e.adam)(t.optParams[0],t.optParams[1],t.optParams[2],t.optParams[3]);default:return(0,e.sgd)()}}},274:(t,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.atan2=e.sqd=e.pow=e.floorDivNoNan=e.floorDiv=e.divNoNan=e.div=e.mult=e.sub=e.add=e.arithOp=void 0;const r=a(512),s=a(198),i=a(865),n=a(115),o=a(928);e.arithOp=t=>(e,a)=>{if("number"!=typeof e){let s=(0,o.ensureTensor)(e);if("number"==typeof a)return new r.Tensor((0,i.forEachReturn)(s.data,(e=>t(e,a))),s.shape);let h=(0,o.ensureTensor)(a),l=s.shape;return(0,o.shapesEqual)(s.shape,h.shape)||(l=(0,n.broadcastArgs)(s.shape,h.shape),s=(0,n.broadcastTo)(s,l),h=(0,n.broadcastTo)(h,l)),new r.Tensor((0,i.forEachOfBothReturn)(s.data,h.data,((e,a)=>t(e,a))),l)}if("number"!=typeof a){let n=a instanceof r.Tensor?a.data:a;return(0,s.fromArray)((0,i.forEachReturn)(n,(a=>t(e,a))))}return new r.Tensor(t(e,a))},e.add=(0,e.arithOp)(((t,e)=>t+e)),e.sub=(0,e.arithOp)(((t,e)=>t-e)),e.mult=(0,e.arithOp)(((t,e)=>t*e)),e.div=(0,e.arithOp)(((t,e)=>t/e)),e.divNoNan=(0,e.arithOp)(((t,e)=>0==e?0:t/e)),e.floorDiv=(0,e.arithOp)(((t,e)=>Math.floor(t/e))),e.floorDivNoNan=(0,e.arithOp)(((t,e)=>Math.floor(0==e?0:t/e))),e.pow=(0,e.arithOp)(((t,e)=>t**e)),e.sqd=(0,e.arithOp)(((t,e)=>(t-e)*(t-e))),e.atan2=(0,e.arithOp)(((t,e)=>Math.atan2(t,e)))},712:(t,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.logNoNan=e.expNoInfinity=e.variance=e.varianceSquared=e.constrain=e.map=e.changeRange=e.remap=e.softmax=e.step=e.softplus=e.elu=e.leakyRelu=e.relu=e.sigmoid=e.trunc=e.tanh=e.tan=e.square=e.sqrt=e.sinh=e.sin=e.sign=e.round=e.log2=e.log10=e.log=e.floor=e.expm1=e.exp=e.cosh=e.cos=e.ceil=e.cbrt=e.atan=e.asinh=e.asin=e.acosh=e.acos=e.abs=e.neg=e.mathOP=void 0;const r=a(928),s=a(805),i=a(512),n=a(865),o=a(274),h=a(374);e.mathOP=t=>e=>{let a=(0,r.ensureTensor)(e),s=(0,n.forEachReturn)(a.data,(e=>t(e)));return new i.Tensor(s,a.shape)},e.neg=(0,e.mathOP)((t=>-t)),e.abs=(0,e.mathOP)((t=>Math.abs(t))),e.acos=(0,e.mathOP)((t=>Math.acos(t))),e.acosh=(0,e.mathOP)((t=>Math.acosh(t))),e.asin=(0,e.mathOP)((t=>Math.asin(t))),e.asinh=(0,e.mathOP)((t=>Math.asinh(t))),e.atan=(0,e.mathOP)((t=>Math.atan(t))),e.cbrt=(0,e.mathOP)((t=>Math.cbrt(t))),e.ceil=(0,e.mathOP)((t=>Math.ceil(t))),e.cos=(0,e.mathOP)((t=>Math.cos(t))),e.cosh=(0,e.mathOP)((t=>Math.cosh(t))),e.exp=(0,e.mathOP)((t=>Math.exp(t))),e.expm1=(0,e.mathOP)((t=>Math.expm1(t))),e.floor=(0,e.mathOP)((t=>Math.floor(t))),e.log=(0,e.mathOP)((t=>Math.log(t))),e.log10=(0,e.mathOP)((t=>Math.log10(t))),e.log2=(0,e.mathOP)((t=>Math.log2(t))),e.round=(0,e.mathOP)((t=>Math.round(t))),e.sign=(0,e.mathOP)((t=>Math.sign(t))),e.sin=(0,e.mathOP)((t=>Math.sin(t))),e.sinh=(0,e.mathOP)((t=>Math.sinh(t))),e.sqrt=(0,e.mathOP)((t=>Math.sqrt(t))),e.square=(0,e.mathOP)((t=>t*t)),e.tan=(0,e.mathOP)((t=>Math.tan(t))),e.tanh=(0,e.mathOP)((t=>Math.tanh(t))),e.trunc=(0,e.mathOP)((t=>Math.trunc(t))),e.sigmoid=(0,e.mathOP)((t=>1/(1+Math.exp(-t)))),e.relu=(0,e.mathOP)((t=>Math.max(0,t))),e.leakyRelu=(0,e.mathOP)((t=>Math.max(.05*t,t))),e.elu=(0,e.mathOP)((t=>t>0?t:.05*(Math.exp(t)-1))),e.softplus=(0,e.mathOP)((t=>Math.log(1+Math.exp(t)))),e.step=(t,e=0)=>{let a=(0,r.ensureTensor)(t),s=(0,n.forEachReturn)(a.data,(t=>t>0?1:e*t));return new i.Tensor(s,a.shape)},e.softmax=t=>{let a=(0,r.ensureTensor)(t),s=(0,o.sub)(a,a.max());return(0,o.div)((0,e.exp)(s),(0,h.sumExp)(s))},e.remap=(t,e,a,s,o)=>{let h=(0,r.ensureTensor)(t),l=(0,n.forEachReturn)(h.data,(t=>(t-e)/(a-e)*(o-s)+s));return new i.Tensor(l,h.shape)},e.changeRange=(t,e=0,a=1)=>{let s=(0,r.ensureTensor)(t),o=(0,n.forEachReturn)(s.data,(t=>(t-(0,h.min)(s.data))/((0,h.max)(s.data)-(0,h.min)(s.data))*(a-e)+e));return new i.Tensor(o,s.shape)},e.map=(t,e)=>{let a=(0,r.ensureTensor)(t),s=(0,n.forEachReturn)(a.data,(t=>e(t)));return new i.Tensor(s,a.shape)},e.constrain=(t,e,a)=>{let s=(0,r.ensureTensor)(t),o=(0,n.forEachReturn)(s.data,(t=>Math.max(Math.min(t,a),e)));return new i.Tensor(o,s.shape)},e.varianceSquared=t=>{let a=(0,r.ensureTensor)(t);return(0,e.square)((0,o.sub)(a,a.mean())).mean()},e.variance=t=>{let a=(0,r.ensureTensor)(t);return Math.sqrt((0,e.square)((0,o.sub)(a,a.mean())).mean())},e.expNoInfinity=(t,e=-50,a=50)=>{let o=(0,r.ensureTensor)(t),h=(0,n.forEachReturn)(o.data,(t=>Math.exp((0,s.constrain)(t,e,a))));return new i.Tensor(h,o.shape)},e.logNoNan=(t,e=1e-100,a=1/0)=>{let o=(0,r.ensureTensor)(t),h=(0,n.forEachReturn)(o.data,(t=>Math.exp((0,s.constrain)(t,e,a))));return new i.Tensor(h,o.shape)}},470:(t,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.maxPoolingVolume=e.maxPooling=e.conv_manyFilters=e.conv_reuseFilter=e.convolution=e.corr_manyFilters_addB=e.corr_manyFilters=e.corr_reuseFilter=e.correlate=e.mp_paddAmount=e.c_c_paddAmount=e.mp_v_outputShape=e.mp_outputShape=e.cc_manyFilters_outputShape=e.cc_reuseFilter_outputShape=e.ccv_outputShape=e.c_c_outputShape=void 0;const r=a(512),s=a(928),i=a(10),n=a(198);e.c_c_outputShape=(t,e,a,r,s)=>{let i=[(t[0]+a[0]-s[0]*(e[0]-1)-1)/r[0]+1,(t[1]+a[1]-s[1]*(e[1]-1)-1)/r[1]+1];return i=[Math.floor(i[0]),Math.floor(i[1])],i},e.ccv_outputShape=(t,e,a,r,s)=>{let i=[t[0],(t[1]+a[0]-s[0]*(e[1]-1)-1)/r[0]+1,(t[2]+a[1]-s[1]*(e[2]-1)-1)/r[1]+1];return i=[Math.floor(i[0]),Math.floor(i[1]),Math.floor(i[2])],i},e.cc_reuseFilter_outputShape=(t,e,a,r,s)=>{let i=[t[0],(t[1]+a[0]-s[0]*(e[0]-1)-1)/r[0]+1,(t[2]+a[1]-s[1]*(e[1]-1)-1)/r[1]+1];return i=[Math.floor(i[0]),Math.floor(i[1]),Math.floor(i[2])],i},e.cc_manyFilters_outputShape=(t,e,a,r,s)=>{let i=[e[0],(t[1]+a[0]-s[0]*(e[2]-1)-1)/r[0]+1,(t[2]+a[1]-s[1]*(e[3]-1)-1)/r[1]+1];return i=[Math.floor(i[0]),Math.floor(i[1]),Math.floor(i[2])],i},e.mp_outputShape=(t,e,a,r)=>[Math.floor((t[0]+e[0]-a[0])/r[0]+1),Math.floor((t[1]+e[1]-a[1])/r[1]+1)],e.mp_v_outputShape=(t,e,a,r)=>[t[0],Math.floor((t[1]+e[0]-a[0])/r[0]+1),Math.floor((t[2]+e[1]-a[1])/r[1]+1)],e.c_c_paddAmount=(t,e,a,r=[1,1],s=[1,1])=>{if("valid"==a)return[0,0];let i,n,o=[t[t.length-2],t[t.length-1]],h=[e[e.length-2],e[e.length-1]];return"same"==a?(i=Math.floor(s[0]*(h[0]-1)+(o[0]-1)*(r[0]-1)),n=Math.floor(s[1]*(h[1]-1)+(o[1]-1)*(r[1]-1)),[i,n]):"full"==a?(i=2*(h[0]-1),n=2*(h[1]-1),[i,n]):[0,0]},e.mp_paddAmount=(t,e,a,r)=>{if(e){let e=[Math.floor((t[t.length-2]-a[0])/r[0])+1,Math.floor((t[t.length-1]-a[1])/r[1])+1],s=[a[0]+(e[0]-1)*r[0],a[1]+(e[1]-1)*r[1]],i=[t[t.length-2]-s[0],t[t.length-1]-s[1]];return[i[0]>0?a[0]-i[0]:0,i[1]>0?a[1]-i[1]:0]}return[0,0]},e.correlate=(t,a,o="valid",h=[1,1],l=[1,1])=>{let u=(0,s.ensureTensor)(t),p=(0,s.ensureTensor)(a),f=o instanceof Array?o:(0,e.c_c_paddAmount)(u.shape,p.shape,o,h,l);if(2==u.rank){let t=(0,e.c_c_outputShape)(u.shape,p.shape,f,h,l),a=(0,i.padding)(u,f),s=[];for(let e=0;e<t[0];e++){s[e]=[];for(let r=0;r<t[1];r++){let t=0;for(let s=0;s<p.shape[0];s++)for(let i=0;i<p.shape[1];i++){let n=s*l[0]+e*h[0],o=i*l[1]+r*h[1];t+=a.data[n][o]*p.data[s][i]}s[e][r]=t}}return new r.Tensor(s,t)}{let t=(0,e.ccv_outputShape)(u.shape,p.shape,f,h,l),a=[];for(let t=0;t<u.shape[0];t++)a[t]=(0,i.padding)(u.data[t],f).data;a=new r.Tensor(a,(0,s.inferShape)(a));let o=(0,n.zeros)(t);for(let e=0;e<a.shape[0];e++)for(let r=0;r<t[1];r++)for(let s=0;s<t[2];s++){let t=0;for(let i=0;i<p.shape[1];i++)for(let n=0;n<p.shape[2];n++){let o=i*l[0]+r*h[0],u=n*l[1]+s*h[1];t+=a.data[e][o][u]*p.data[e][i][n]}o.data[e][r][s]+=t}return o}},e.corr_reuseFilter=(t,a,o="valid",h=[1,1],l=[1,1])=>{let u=(0,s.ensureTensor)(t),p=(0,s.ensureTensor)(a),f=o instanceof Array?o:(0,e.c_c_paddAmount)(u.shape,p.shape,o,h,l);p.shape.slice().shift();let d=(0,e.cc_reuseFilter_outputShape)(u.shape,p.shape,f,h,l),c=[];for(let t=0;t<u.shape[0];t++)c[t]=(0,i.padding)(u.data[t],f).data;c=new r.Tensor(c,(0,s.inferShape)(c));let m=(0,n.zeros)(d);for(let t=0;t<c.shape[0];t++)for(let e=0;e<d[1];e++)for(let a=0;a<d[2];a++){let r=0;for(let s=0;s<p.shape[2];s++)for(let i=0;i<p.shape[3];i++){let n=s*l[0]+e*h[0],o=i*l[1]+a*h[1];r+=c.data[t][n][o]*p.data[s][i]}m.data[t][e][a]+=r}return m},e.corr_manyFilters=(t,a,o="valid",h=[1,1],l=[1,1])=>{let u=(0,s.ensureTensor)(t),p=(0,s.ensureTensor)(a),f=o instanceof Array?o:(0,e.c_c_paddAmount)(u.shape,p.shape,o,h,l),d=[];for(let t=0;t<u.shape[0];t++)d[t]=(0,i.padding)(u.data[t],f).data;d=new r.Tensor(d,(0,s.inferShape)(d));let c=(0,e.cc_manyFilters_outputShape)(u.shape,p.shape,f,h,l),m=(0,n.zeros)(c);for(let t=0;t<p.shape[0];t++)for(let e=0;e<u.shape[0];e++)for(let a=0;a<c[1];a++)for(let r=0;r<c[2];r++){let s=0;for(let i=0;i<p.shape[2];i++)for(let n=0;n<p.shape[3];n++){let o=i*l[0]+a*h[0],u=n*l[1]+r*h[1];s+=d.data[e][o][u]*p.data[t][e][i][n]}m.data[t][a][r]+=s}return m},e.corr_manyFilters_addB=(t,a,o,h="valid",l=[1,1],u=[1,1])=>{let p=(0,s.ensureTensor)(t),f=(0,s.ensureTensor)(a),d=(0,s.ensureTensor)(o),c=h instanceof Array?h:(0,e.c_c_paddAmount)(p.shape,f.shape,h,l,u),m=[];for(let t=0;t<p.shape[0];t++)m[t]=(0,i.padding)(p.data[t],c).data;m=new r.Tensor(m,(0,s.inferShape)(m));let g=(0,e.cc_manyFilters_outputShape)(p.shape,f.shape,c,l,u),b=(0,n.zeros)(g);for(let t=0;t<f.shape[0];t++)for(let e=0;e<p.shape[0];e++)for(let a=0;a<g[1];a++)for(let r=0;r<g[2];r++){let s=0;for(let i=0;i<f.shape[2];i++)for(let n=0;n<f.shape[3];n++){let o=i*u[0]+a*l[0],h=n*u[1]+r*l[1];s+=m.data[e][o][h]*f.data[t][e][i][n]}b.data[t][a][r]+=s+d.data[t][a][r]/g[0]}return b},e.convolution=(t,a,o="valid",h=[1,1],l=[1,1])=>{let u=(0,s.ensureTensor)(t),p=(0,s.ensureTensor)(a),f=o instanceof Array?o:(0,e.c_c_paddAmount)(u.shape,p.shape,o,h,l);if(2==u.rank){let t=(0,i.rotate180)(p),a=(0,e.c_c_outputShape)(u.shape,p.shape,f,h,l),s=(0,i.padding)(u,f),n=[];for(let e=0;e<a[0];e++){n[e]=[];for(let r=0;r<a[1];r++){let a=0;for(let i=0;i<t.shape[0];i++)for(let n=0;n<t.shape[1];n++){let o=i*l[0]+e*h[0],u=n*l[1]+r*h[1];a+=s.data[o][u]*t.data[i][n]}n[e][r]=a}}return new r.Tensor(n,a)}{let t=(0,e.ccv_outputShape)(u.shape,p.shape,f,h,l),a=[],o=[];for(let t=0;t<u.shape[0];t++)a[t]=(0,i.padding)(u.data[t],f).data,o[t]=(0,i.rotate180)(p.data[t]).data;a=new r.Tensor(a,(0,s.inferShape)(a)),o=new r.Tensor(o,p.shape);let d=(0,n.zeros)(t);for(let e=0;e<a.shape[0];e++)for(let r=0;r<t[1];r++)for(let s=0;s<t[2];s++){let t=0;for(let i=0;i<o.shape[1];i++)for(let n=0;n<o.shape[2];n++){let u=i*l[0]+r*h[0],p=n*l[1]+s*h[1];t+=a.data[e][u][p]*o.data[e][i][n]}d.data[e][r][s]+=t}return d}},e.conv_reuseFilter=(t,a,o="valid",h=[1,1],l=[1,1])=>{let u=(0,s.ensureTensor)(t),p=(0,s.ensureTensor)(a),f=o instanceof Array?o:(0,e.c_c_paddAmount)(u.shape,p.shape,o,h,l);p.shape.slice().shift();let d=(0,e.cc_reuseFilter_outputShape)(u.shape,p.shape,f,h,l),c=[];for(let t=0;t<u.shape[0];t++)c[t]=(0,i.padding)(u.data[t],f).data;c=new r.Tensor(c,(0,s.inferShape)(c));let m=(0,i.rotate180)(p),g=(0,n.zeros)(d);for(let t=0;t<c.shape[0];t++)for(let e=0;e<d[1];e++)for(let a=0;a<d[2];a++){let r=0;for(let s=0;s<m.shape[2];s++)for(let i=0;i<m.shape[3];i++){let n=s*l[0]+e*h[0],o=i*l[1]+a*h[1];r+=c.data[t][n][o]*m.data[s][i]}g.data[t][e][a]+=r}return g},e.conv_manyFilters=(t,a,o="valid",h=[1,1],l=[1,1])=>{let u=(0,s.ensureTensor)(t),p=(0,s.ensureTensor)(a),f=o instanceof Array?o:(0,e.c_c_paddAmount)(u.shape,p.shape,o,h,l),d=[];for(let t=0;t<u.shape[0];t++)d[t]=(0,i.padding)(u.data,f).data;d=new r.Tensor(d,(0,s.inferShape)(d));let c=[];for(let t=0;t<p.shape[0];t++){c[t]=[];for(let e=0;e<p.shape[1];e++)c[t][e]=(0,i.rotate180)(p.data[t][e]).data}c=new r.Tensor(c,p.shape);let m=(0,e.cc_manyFilters_outputShape)(u.shape,c.shape,f,h,l),g=(0,n.zeros)(m);for(let t=0;t<c.shape[0];t++)for(let e=0;e<u.shape[0];e++)for(let a=0;a<m[1];a++)for(let r=0;r<m[2];r++){let s=0;for(let i=0;i<c.shape[2];i++)for(let n=0;n<c.shape[3];n++){let o=i*l[0]+a*h[0],u=n*l[1]+r*h[1];s+=d.data[e][o][u]*c.data[t][e][i][n]}g.data[t][a][r]+=s}return g},e.maxPooling=(t,a,r=[2,2],o=r,h)=>{h=[];let l=(0,s.ensureTensor)(t),u=a instanceof Array?a.slice():(0,e.mp_paddAmount)(l.shape,a,r,o),p=(0,i.padding)(l.data,u),f=(0,e.mp_outputShape)(l.shape,u,r,o),d=(0,n.zeros)(f);for(let t=0;t<f[0];t++)for(let e=0;e<f[1];e++){let a=-1/0,s=[];for(let i=0;i<r[0];i++)for(let n=0;n<r[1];n++){let r=i+t*o[0],h=n+e*o[1];p.data[r][h]>a&&(a=p.data[r][h],s=[r,h,t,e])}h.push(s),d.data[t][e]=a}return d},e.maxPoolingVolume=(t,a,r=[2,2],o=r,h=[])=>{h=[];let l=(0,s.ensureTensor)(t),u=a instanceof Array?a.slice():(0,e.mp_paddAmount)(l.shape,a,r,o),p=[];for(let t=0;t<l.shape[0];t++)p[t]=(0,i.padding)(l.data[t],u).data;p=(0,n.tensor)(p);let f=(0,e.mp_v_outputShape)(l.shape,u,r,o),d=(0,n.zeros)(f);for(let t=0;t<p.shape[0];t++)for(let e=0;e<f[1];e++)for(let a=0;a<f[2];a++){let s=-1/0,i=[];for(let n=0;n<r[0];n++)for(let h=0;h<r[1];h++){let r=n+e*o[0],l=h+a*o[1];p.data[t][r][l]>s&&(s=p.data[t][r][l],i=[t,r,l,e,a])}h.push(i),d.data[t][e][a]=s}return d}},10:(t,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.padding=e.rotate270=e.rotate90=e.rotate180=e.mirrorVertically=e.mirrorHorizontally=e.transpose=e.dot=e.dotVxV=e.dotVxM=e.dotMxV=e.dotMxM=void 0;const r=a(512),s=a(928);e.dotMxM=(t,e)=>{if(t.shape[1]!==e.shape[0])throw console.error("Colums of A must match rows of B");let a=[];for(let r=0;r<t.shape[0];r++){a[r]=[];for(let s=0;s<e.shape[1];s++){let i=0;for(let a=0;a<t.shape[1];a++)i+=t.data[r][a]*e.data[a][s];a[r][s]=i}}return new r.Tensor(a,[t.shape[0],e.shape[1]])},e.dotMxV=(t,e)=>{if(t.shape[1]!==e.shape[0])throw console.error("Colums of A must match rows of B");let a=[];for(let r=0;r<t.shape[0];r++){let s=0;for(let a=0;a<t.shape[1];a++)s+=t.data[r][a]*e.data[a];a[r]=s}return new r.Tensor(a,[t.shape[0]])},e.dotVxM=(t,e)=>{if(1!==e.shape[0])throw console.error("Colums of A must match rows of B");let a=[];for(let r=0;r<t.shape[0];r++){a[r]=[];for(let s=0;s<e.shape[1];s++)a[r][s]=t.data[r]*e.data[0][s]}return new r.Tensor(a,[t.shape[0],e.shape[1]])},e.dotVxV=(t,e)=>{if(t.shape[0]!==e.shape[0])throw console.error("Colums of A must match rows of B");let a=0;for(let r=0;r<t.shape[0];r++)a+=t.data[r]*e.data[r];return new r.Tensor(a,[])},e.dot=(t,a)=>2==t.rank?2==a.rank?(0,e.dotMxM)(t,a):(0,e.dotMxV)(t,a):2==a.rank?(0,e.dotVxM)(t,a):(0,e.dotVxV)(t,a),e.transpose=t=>{let e=(0,s.ensureTensor)(t);if(2==e.rank){let t=[];for(let a=0;a<e.shape[1];a++){t[a]=[];for(let r=0;r<e.shape[0];r++)t[a][r]=e.data[r][a]}return new r.Tensor(t,[e.shape[1],e.shape[0]])}{let t=[[]];for(let a=0;a<e.shape[0];a++)t[0][a]=e.data[a];return new r.Tensor(t,[1,e.shape[0]])}},e.mirrorHorizontally=t=>{let e=(0,s.ensureTensor)(t),a=[];for(let t=0;t<e.shape[0];t++){a[t]=[];for(let r=0,s=e.shape[1]-1;r<s;r++,s--)a[t][r]=e.data[t][s],a[t][s]=e.data[t][r]}return new r.Tensor(a,e.shape)},e.mirrorVertically=t=>{let e=(0,s.ensureTensor)(t),a=[];for(let t=0;t<e.shape[1];t++)a[t]=[];for(let t=0;t<e.shape[1];t++)for(let r=0,s=e.shape[0]-1;r<s;r++,s--)a[r][t]=e.data[s][t],a[s][t]=e.data[r][t];return new r.Tensor(a,e.shape)},e.rotate180=t=>{let e=(0,s.ensureTensor)(t),a=[];for(let t=0;t<e.shape[0];t++){a[t]=e.data[t].slice();for(let r=0,s=e.shape[1]-1;r<s;r++,s--)a[t][r]=e.data[t][s],a[t][s]=e.data[t][r]}for(let t=0;t<e.shape[1];t++)for(let r=0,s=e.shape[0]-1;r<s;r++,s--)a[r][t]=e.data[s][t],a[s][t]=e.data[r][t];return new r.Tensor(a,e.shape)},e.rotate90=t=>{let e=(0,s.ensureTensor)(t),a=[],i=0,n=0;for(let t=0;t<e.shape[1];t++){a[n]=[],i=0;for(let r=e.shape[0]-1;r>=0;r--)a[n][i]=e.data[r][t],i++;n++}return new r.Tensor(a,[e.shape[1],e.shape[0]])},e.rotate270=t=>{let e,a=(0,s.ensureTensor)(t),i=[],n=0;for(let t=a.shape[1]-1;t>=0;t--){i[n]=[],e=0;for(let r=0;r<a.shape[0];r++)i[n][e]=a.data[r][t],e++;n++}return new r.Tensor(i,[a.shape[1],a.shape[0]])},e.padding=(t,e)=>{let a=(0,s.ensureTensor)(t);if(0==e[0]&&0==e[1])return a;let i=e[0],n=e[1],o=Math.floor(e[0]/2),h=e[0]-o,l=Math.floor(e[1]/2),u=e[1]-l,p=[];for(let t=0;t<a.shape[1];t++){p[t]=a.data[t].slice();for(let e=0;e<l;e++)p[t].unshift(0);for(let e=0;e<u;e++)p[t].push(0)}for(let t=0;t<o;t++)p.unshift(new Array(p[0].length).fill(0));for(let t=0;t<h;t++)p.push(new Array(p[0].length).fill(0));return new r.Tensor(p,[a.shape[0]+i,a.shape[1]+n])}},374:(t,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.sum=e.min=e.max=e.sumExp=e.mean=void 0;const r=a(928),s=a(805);e.mean=t=>{let e=0,a=0;return(0,r.ensureTensor)(t).forEach((t=>(a++,e+=t,t))),e/a},e.sumExp=t=>{let e=(0,r.ensureTensor)(t),a=0;return e.forEach((t=>(a+=Math.exp((0,s.constrain)(t,-50,50)),t))),a},e.max=t=>{let e=(0,r.ensureTensor)(t),a=-1/0;return e.forEach((t=>(a=t>a?t:a,t))),a},e.min=t=>{let e=(0,r.ensureTensor)(t),a=1/0;return e.forEach((t=>(a=t<a?t:a,t))),a},e.sum=t=>{let e=(0,r.ensureTensor)(t),a=0;return e.forEach((t=>(a+=t,t))),a}},198:(t,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.range=e.oneHot=e.onesLike=e.ones=e.zerosLike=e.zeros=e.fill=e.identity=e.create=e.tensor=e.scalar=e.fromArray=e.fromVector=e.fromObject=void 0;const r=a(512),s=a(928);e.fromObject=t=>new r.Tensor(t.data,t.shape),e.fromVector=(t,e=[t.length])=>{let a=1;for(let t=0;t<e.length;t++)a*=e[t];if(a!==t.length)throw console.error("Based on the provided shape the tensor should have "+a+" values but has "+t.length);let s=t;for(let t=e.length-1;t>=0;t--){let a=[],r=0;for(let i=0;i<s.length/e[t];i++){a[i]=[];for(let n=0;n<e[t];n++)a[i][n]=s[r],r++}s=a}return s=s[0],new r.Tensor(s,e)},e.fromArray=(t,e)=>(e=e||(0,s.inferShape)(t),new r.Tensor(t,e)),e.scalar=t=>new r.Tensor(t,[],0),e.tensor=(t,a=(0,s.inferShape)(t))=>!(t[0]instanceof Array)&&a.length>1?(0,e.fromVector)(t,a):new r.Tensor(t,a),e.create=(t,a=(0,s.inferShape)(t))=>!(t[0]instanceof Array)&&a.length>1?(0,e.fromVector)(t,a):new r.Tensor(t,a),e.identity=t=>{let e=[];for(let a=0;a<t[0];a++){e[a]=[];for(let r=0;r<t[1];r++)e[a][r]=a==r?1:0}return new r.Tensor(e,t)},e.fill=(t,a=0)=>{let r=1;for(let e=0;e<t.length;e++)r*=t[e];let s=[];for(let t=0;t<r;t++)s[t]=a;return(0,e.fromVector)(s,t)},e.zeros=t=>{let a=1;for(let e=0;e<t.length;e++)a*=t[e];let r=[];for(let t=0;t<a;t++)r[t]=0;return(0,e.fromVector)(r,t)},e.zerosLike=t=>{let a=(0,s.ensureTensor)(t),r=1;for(let t=0;t<a.rank;t++)r*=a.shape[t];let i=[];for(let t=0;t<r;t++)i[t]=0;return(0,e.fromVector)(i,a.shape)},e.ones=t=>{let a=1;for(let e=0;e<t.length;e++)a*=t[e];let r=[];for(let t=0;t<a;t++)r[t]=1;return(0,e.fromVector)(r,t)},e.onesLike=t=>{let a=(0,s.ensureTensor)(t),r=1;for(let t=0;t<a.rank;t++)r*=a.shape[t];let i=[];for(let t=0;t<r;t++)i[t]=1;return(0,e.fromVector)(i,a.shape)},e.oneHot=(t,a)=>{if("number"==typeof t){let r=(0,e.zeros)([a]);return r.data instanceof Array&&void 0!==r.data[t]&&(r.data[t]=1),r}let r=(0,s.ensureTensor)(t),i=r.shape.slice();i.push(a);let n=(0,e.zeros)(i),o=0;return n.accesLastArray((t=>{let e=r.data[o];void 0!==t[e]&&(t[e]=1),o++})),n},e.range=(t,e,a=1)=>{let s=[];if(a=Math.abs(a),t<e)for(;t<e;)s.push(t),t+=a;else for(;t<e;)s.push(t),t-=a;return new r.Tensor(s,[s.length])}},865:function(t,e,a){var r=this&&this.__createBinding||(Object.create?function(t,e,a,r){void 0===r&&(r=a),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[a]}})}:function(t,e,a,r){void 0===r&&(r=a),t[r]=e[a]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)"default"!==a&&Object.prototype.hasOwnProperty.call(t,a)&&r(e,t,a);return s(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.accesLastArraysReturn=e.accesLastArrays=e.accesLastArrayReturn=e.accesLastArray=e.forEachOfBothReturn=e.forEachOfBoth=e.forEachReturn=e.forEach=void 0;const n=i(a(198));e.forEach=(t,e)=>{let a=t=>{if(t[0]instanceof Array)for(let e=0;e<t.length;e++)a(t[e]);else for(let a=0;a<t.length;a++)t[a]=e(t[a])};return t instanceof Array?(a(t),t):e(t)},e.forEachReturn=(t,e)=>{let a=(t,r)=>{if(t[0]instanceof Array)for(let e=0;e<t.length;e++)r[e]=[],a(t[e],r[e]);else for(let a=0;a<t.length;a++)r[a]=e(t[a])};if(t instanceof Array){let e=[];return a(t,e),e}return e(t)},e.forEachOfBoth=(t,a,r)=>{let s=(t,e)=>{if(t[0]instanceof Array)for(let a=0;a<t.length;a++)s(t[a],e[a]);else for(let a=0;a<t.length;a++)t[a]=r(t[a],e[a])};return t instanceof Array?a instanceof Array?(s(t,a),t):(0,e.forEach)(t,(t=>r(t,a))):a instanceof Array?n.tensor((0,e.forEachReturn)(a,(e=>r(e,t)))):r(t,a)},e.forEachOfBothReturn=(t,a,r)=>{let s=(t,e,a)=>{if(t[0]instanceof Array)for(let r=0;r<t.length;r++)a[r]=[],s(t[r],e[r],a[r]);else for(let s=0;s<t.length;s++)a[s]=r(t[s],e[s])};if(t instanceof Array){if(a instanceof Array){let e=[];return s(t,a,e),e}return(0,e.forEachReturn)(t,(t=>r(t,a)))}return a instanceof Array?(0,e.forEachReturn)(a,(e=>r(e,t))):r(t,a)},e.accesLastArray=(t,e)=>{let a=t=>{if(t[0]instanceof Array)for(let e=0;e<t.length;e++)a(t[e]);else e(t)};return a(t),t},e.accesLastArrayReturn=(t,e)=>{let a=[],r=(t,a)=>{if(t[0]instanceof Array)for(let e=0;e<t.length;e++)a[e]=[],r(t[e],a[e]);else e(t,a)};return r(t,a),a},e.accesLastArrays=(t,e,a)=>{let r=(t,e)=>{if(t[0]instanceof Array)for(let a=0;a<t.length;a++)r(t[a],e[a]);else a(t,e)};r(t,e)},e.accesLastArraysReturn=(t,e,a)=>{let r=[],s=(t,e,r)=>{if(t[0]instanceof Array)for(let a=0;a<t.length;a++)r[a]=[],s(t[a],e[a],r[a]);else a(t,e,r)};return s(t,e,r),r}},115:function(t,e,a){var r=this&&this.__createBinding||(Object.create?function(t,e,a,r){void 0===r&&(r=a),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[a]}})}:function(t,e,a,r){void 0===r&&(r=a),t[r]=e[a]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)"default"!==a&&Object.prototype.hasOwnProperty.call(t,a)&&r(e,t,a);return s(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.unstack=e.stack=e.broadcastArgs=e.broadcastTo=e.tile=e.vectorToTensor=e.reshape=e.flatten=void 0;const n=i(a(198)),o=a(512),h=a(928);e.flatten=t=>{let e=(0,h.ensureTensor)(t),a=[];return e.forEach((t=>(a.push(t),t))),new o.Tensor(a,[a.length])},e.reshape=(t,a)=>(0,e.flatten)(t).vectorToTensor(a),e.vectorToTensor=(t,e)=>{let a=1;for(let t=0;t<e.length;t++)a*=e[t];let r=(0,h.ensureTensor)(t);if(a==r.data.length){let t=r.data;for(let a=e.length-1;a>=0;a--){let r=[],s=0;for(let i=0;i<t.length/e[a];i++){r[i]=[];for(let n=0;n<e[a];n++)r[i][n]=t[s],s++}t=r}return t=t[0],new o.Tensor(t,e)}throw console.error("Based on the provided shape the tensor should have "+a+" values but has "+r.data.length)},e.tile=(t,e)=>{let a=(0,h.ensureTensor)(t);if(e.length!==a.rank)throw console.error("Dimentions in reps "+e+" does not match with the number of dimentions from tensor "+a.shape);let r=[];for(let t=0;t<a.rank;t++)r[t]=e[t]*a.shape[t];let s=[],i=(t,e,s)=>{if(t[0]instanceof Array)for(let n=0;n<r[s];n++)e[n]=[],i(t[n%a.shape[s]],e[n],s+1);else for(let s=0;s<r[r.length-1];s++)e[s]=t[s%a.shape[a.rank-1]]};return i(a.data,s,0),n.fromArray(s,r)},e.broadcastTo=(t,a)=>{let r=(0,h.ensureTensor)(t),s=r.shape.slice();if(a.length<r.rank)throw console.error("Rank from shape "+a.length+" is minor than tensor rank "+r.rank);let i=r;if(a.length>r.rank){let t=s.slice();for(;t.length<a.length;)t.unshift(1);i=(0,e.reshape)(r,t)}let n=a.slice();for(let t=0;t<a.length;t++)if(i.shape[t]===a[t])n[t]=1;else if(1!==i.shape[t])throw console.error(s+" cannot be broadcast to "+a);return(0,e.tile)(i,n)},e.broadcastArgs=(t,e)=>{let a=t.slice(),r=e.slice();if(a.length>r.length)for(;r.length<a.length;)r.unshift(1);else for(;a.length<r.length;)a.unshift(1);let s=[];for(let t=0;t<a.length;t++)s[t]=Math.max(a[t],r[t]);return s},e.stack=t=>{let e=[],a=t[0].shape;for(let r=0;r<t.length;r++){for(let e=0;e<t[r].rank;e++)if(t[r].shape[e]!==a[e])return void console.error("Tensors must have the same shape");e[r]=t[r].data}return a.unshift(t.length),new o.Tensor(e,a)},e.unstack=t=>{let e=(0,h.ensureTensor)(t),a=e.shape.slice();a.shift();let r=[];for(let t=0;t<e.data.length;t++)r[t]=new o.Tensor(e.data[t],a);return r}},928:(t,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.random=e.copy=e.rangeOfValues=e.arraysEqual=e.shapesEqual=e.size=e.shuffleMatch=e.shuffle=e.ensureTensor=e.inferRank=e.inferShape=void 0;const r=a(512),s=a(198);e.inferShape=t=>{let e=[],a=t;for(;a instanceof Array;)e.push(a.length),a=a[0];return e},e.inferRank=t=>{let e=0,a=t;for(;a instanceof Array;)e+=1,a=a[0];return e},e.ensureTensor=t=>t instanceof r.Tensor?t:new r.Tensor(t,(0,e.inferShape)(t)),e.shuffle=t=>{let e=t.length-1;for(;e>0;){let a=Math.floor(Math.random()*e+1),r=t[e];t[e]=t[a],t[a]=r,e-=1}return t},e.shuffleMatch=(t,e)=>{let a=t.length-1;for(;a>0;){let r=Math.floor(Math.random()*a+1),s=t[a],i=e[a];t[a]=t[r],e[a]=e[r],t[r]=s,e[r]=i,a-=1}return[t,e]},e.size=t=>{let a=(0,e.ensureTensor)(t),r=1;for(let t=0;t<a.shape.length;t++)r*=a.shape[t];return r},e.shapesEqual=(t,e)=>{if(t.length!==e.length)return!1;for(let a=0;a<t.length;a++)if(t[a]!==e[a])return!1;return!0},e.arraysEqual=(t,e)=>{if(t.length!==e.length)return!1;for(let a=0;a<t.length;a++)if(t[a]!==e[a])return!1;return!0},e.rangeOfValues=t=>{let a=-1/0,r=1/0;return(0,e.ensureTensor)(t).forEach((t=>(a=t>a?t:a,r=t<r?t:r,t))),[r,a]},e.copy=t=>{let a=(t,e)=>{if(e[0]instanceof Array)for(let r=0;r<e.length;r++)t[r]=[],a(t[r],e[r]);else for(let a=0;a<e.length;a++)t[a]=e[a]},s=(0,e.ensureTensor)(t);if(s.data instanceof Array){let t=[];return a(t,s.data),new r.Tensor(t,s.shape)}return new r.Tensor(s.data,s.shape)},e.random=(t,e=[])=>{t instanceof r.Tensor&&(t=t.shape);let a=null==e[0]?-1:e[0],i=null==e[1]?1:e[1],n=e[2],o=1;for(let e=0;e<t.length;e++)o*=t[e];let h=[];if(null==n)for(let t=0;t<o;t++)h[t]=Math.random()*(i-a)+a;else for(let t=0;t<o;t++)h[t]=Math.floor(Math.random()*(i-a)+a);return(0,s.fromVector)(h,t)}},512:(t,e,a)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Tensor=void 0;const r=a(928),s=a(805),i=a(115);class n{constructor(t,e=[],a=e.length){this.data=t,this.shape=e,this.rank=a}add(t){if("number"==typeof t)return this.setData(this.forEach((e=>e+t)),this.shape);let e=(0,r.ensureTensor)(t),a=this.shape;return this.shapesEqual(e.shape)||(a=this.broadcastArgs(e.shape),this.broadcastTo(a),e=(0,i.broadcastTo)(e,a)),this.setData(this.forEachOfBoth(e.data,((t,e)=>t+e)),a)}sub(t){if("number"==typeof t)return this.setData(this.forEach((e=>e-t)),this.shape);let e=(0,r.ensureTensor)(t),a=this.shape;return this.shapesEqual(e.shape)||(a=this.broadcastArgs(e.shape),this.broadcastTo(a),e=(0,i.broadcastTo)(e,a)),this.setData(this.forEachOfBoth(e.data,((t,e)=>t-e)),a)}mult(t){if("number"==typeof t)return this.setData(this.forEach((e=>e*t)),this.shape);let e=(0,r.ensureTensor)(t),a=this.shape;return this.shapesEqual(e.shape)||(a=this.broadcastArgs(e.shape),this.broadcastTo(a),e=(0,i.broadcastTo)(e,a)),this.setData(this.forEachOfBoth(e.data,((t,e)=>t*e)),a)}div(t){if("number"==typeof t)return this.setData(this.forEach((e=>e/t)),this.shape);let e=(0,r.ensureTensor)(t),a=this.shape;return this.shapesEqual(e.shape)||(a=this.broadcastArgs(e.shape),this.broadcastTo(a),e=(0,i.broadcastTo)(e,a)),this.setData(this.forEachOfBoth(e.data,((t,e)=>t/e)),a)}divNoNan(t){if("number"==typeof t)return this.setData(this.forEach((e=>0==t?0:e/t)),this.shape);let e=(0,r.ensureTensor)(t),a=this.shape;return this.shapesEqual(e.shape)||(a=this.broadcastArgs(e.shape),this.broadcastTo(a),e=(0,i.broadcastTo)(e,a)),this.setData(this.forEachOfBoth(e.data,((t,e)=>0==e?0:t/e)),a)}floorDiv(t){if("number"==typeof t)return this.setData(this.forEach((e=>Math.floor(e/t))),this.shape);let e=(0,r.ensureTensor)(t),a=this.shape;return this.shapesEqual(e.shape)||(a=this.broadcastArgs(e.shape),this.broadcastTo(a),e=(0,i.broadcastTo)(e,a)),this.setData(this.forEachOfBoth(e.data,((t,e)=>Math.floor(t/e))),a)}floorDivNoNan(t){if("number"==typeof t)return this.setData(this.forEach((e=>Math.floor(0==t?0:e/t))),this.shape);let e=(0,r.ensureTensor)(t),a=this.shape;return this.shapesEqual(e.shape)||(a=this.broadcastArgs(e.shape),this.broadcastTo(a),e=(0,i.broadcastTo)(e,a)),this.setData(this.forEachOfBoth(e.data,((t,e)=>Math.floor(0==e?0:t/e))),a)}pow(t){if("number"==typeof t)return this.setData(this.forEach((e=>e**t)),this.shape);let e=(0,r.ensureTensor)(t),a=this.shape;return this.shapesEqual(e.shape)||(a=this.broadcastArgs(e.shape),this.broadcastTo(a),e=(0,i.broadcastTo)(e,a)),this.setData(this.forEachOfBoth(e.data,((t,e)=>t**e)),a)}sqd(t){if("number"==typeof t)return this.setData(this.forEach((e=>(e-t)**2)),this.shape);let e=(0,r.ensureTensor)(t),a=this.shape;return this.shapesEqual(e.shape)||(a=this.broadcastArgs(e.shape),this.broadcastTo(a),e=(0,i.broadcastTo)(e,a)),this.setData(this.forEachOfBoth(e.data,((t,e)=>(t-e)**2)),a)}square(){return this.forEach((t=>t**2)),this}sqrt(){return this.forEach((t=>t**.5)),this}remap(t,e,a,r){return this.forEach((s=>(s-t)/(e-t)*(r-a)+a)),this}map(t){return this.forEach((e=>t(e))),this}neg(){return this.forEach((t=>-t)),this}log(){return this.forEach((t=>0==t?-1e3:Math.log(t))),this}constrain(t,e=1){let a,r;return t instanceof Array?(a=t[0],r=t[1]):(a=t,r=e),this.forEach((t=>Math.max(Math.min(t,r),a))),this}exp(){return this.forEach((t=>Math.exp((0,s.constrain)(t,-50,50)))),this}dot(t){let e=(0,r.ensureTensor)(t);return 2==this.rank?2==e.rank?this.dotMxM(e):this.dotMxV(e):2==e.rank?this.dotVxM(e):this.dotVxV(e)}dotMxM(t){if(this.shape[1]!==t.shape[0])throw console.error("Colums of A must match rows of B");let e=[];for(let a=0;a<this.shape[0];a++){e[a]=[];for(let r=0;r<t.shape[1];r++){let s=0;for(let e=0;e<this.shape[1];e++)s+=this.data[a][e]*t.data[e][r];e[a][r]=s}}return this.data=e,this.shape=[this.shape[0],t.shape[1]],this.rank=this.shape.length,this}dotMxV(t){if(this.shape[1]!==t.shape[0])throw console.error("Colums of A must match rows of B");let e=[];for(let a=0;a<this.shape[0];a++){let r=0;for(let e=0;e<this.shape[1];e++)r+=this.data[a][e]*t.data[e];e[a]=r}return this.data=e,this.shape=[this.shape[0]],this.rank=this.shape.length,this}dotVxM(t){if(1!==t.shape[0])throw console.error("Colums of A must match rows of B");let e=[];for(let a=0;a<this.shape[0];a++){e[a]=[];for(let r=0;r<t.shape[1];r++)e[a][r]=this.data[a]*t.data[0][r]}return this.data=e,this.shape=[this.shape[0],t.shape[1]],this.rank=this.shape.length,this}dotVxV(t){if(this.shape[0]!==t.shape[0])throw console.error("Colums of A must match rows of B");let e=0;for(let a=0;a<this.shape[0];a++)e+=this.data[a]*t.data[a];return this.data=e,this.shape=[],this.rank=0,this}transpose(){if(2==this.rank){let t=[];for(let e=0;e<this.shape[1];e++){t[e]=[];for(let a=0;a<this.shape[0];a++)t[e][a]=this.data[a][e]}return this.data=t,this.shape=[this.shape[1],this.shape[0]],this}let t=[[]];for(let e=0;e<this.shape[0];e++)t[0][e]=this.data[e];return this.data=t,this.shape=[1,this.shape[0]],this.rank=2,this}mirrorHorizontally(){for(let t=0;t<this.shape[0];t++)for(let e=0,a=this.shape[1]-1;e<a;e++,a--){let r=this.data[t][e];this.data[t][e]=this.data[t][a],this.data[t][a]=r}return this}mirrorVertically(){for(let t=0;t<this.shape[1];t++)for(let e=0,a=this.shape[0]-1;e<a;e++,a--){let r=this.data[e][t];this.data[e][t]=this.data[a][t],this.data[a][t]=r}return this}rotate180(){for(let t=0;t<this.shape[0];t++)for(let e=0,a=this.shape[1]-1;e<a;e++,a--){let r=this.data[t][e];this.data[t][e]=this.data[t][a],this.data[t][a]=r}for(let t=0;t<this.shape[1];t++)for(let e=0,a=this.shape[0]-1;e<a;e++,a--){let r=this.data[e][t];this.data[e][t]=this.data[a][t],this.data[a][t]=r}return this}rotate90(){let t=[],e=0,a=0;for(let r=0;r<this.shape[1];r++){t[a]=[],e=0;for(let s=this.shape[0]-1;s>=0;s--)t[a][e]=this.data[s][r],e++;a++}return this.data=t,this.shape=[this.shape[1],this.shape[0]],this}rotate270(){let t,e=[],a=0;for(let r=this.shape[1]-1;r>=0;r--){e[a]=[],t=0;for(let s=0;s<this.shape[0];s++)e[a][t]=this.data[s][r],t++;a++}return this.data=e,this.shape=[this.shape[1],this.shape[0]],this}shuffle(){let t=this.shape[0]-1;for(;t>0;){let e=Math.floor(Math.random()*t+1),a=this.data[t];this.data[t]=this.data[e],this.data[e]=a,t-=1}return this}fill(t=0){return this.forEach((()=>t)),this}size(){let t=1;for(let e=0;e<this.rank;e++)t*=this.shape[e];return t}rangeOfValues(){let t=-1/0,e=1/0;return this.forEach((a=>(t=a>t?a:t,e=a<e?a:e,a))),[e,t]}setData(t,e,a){return this.data=t,this.shape=e||(0,r.inferShape)(t),this.rank=a||this.shape.length,this}shapesEqual(t){if(this.rank!==t.length)return!1;for(let e=0;e<this.rank;e++)if(this.shape[e]!==t[e])return!1;return!0}inferShape(){let t=[],e=this.data;for(;e instanceof Array;)t.push(e.length),e=e[0];return t}inferRank(){let t=0,e=this.data;for(;e instanceof Array;)t+=1,e=e[0];return t}copy(){let t=(e,a)=>{if(a[0]instanceof Array)for(let r=0;r<a.length;r++)e[r]=[],t(e[r],a[r]);else for(let t=0;t<this.shape[this.rank-1];t++)e[t]=a[t]};if(this.data instanceof Array){let e=[];return t(e,this.data),new n(e,this.shape)}return new n(this.data,this.shape)}randomize(t=[]){let e=null==t[0]?-1:t[0],a=null==t[1]?1:t[1];return null==t[2]?this.forEach((()=>Math.random()*(a-e)+e)):this.forEach((()=>Math.floor(Math.random()*(a+1-e)+e))),this}mean(){let t=0,e=0;return this.forEach((a=>(e++,t+=a,a))),t/e}sumExp(){let t=0;return this.forEach((e=>(t+=Math.exp((0,s.constrain)(e,-50,50)),e))),t}max(){let t=-1/0;return this.forEach((e=>(t=e>t?e:t,e))),t}sum(){let t=0;return this.forEach((e=>(t+=e,e))),t}flatten(){let t=[];return this.forEach((e=>(t.push(e),e))),this.setData(t)}reshape(t){return this.flatten().vectorToTensor(t)}vectorToTensor(t){let e=1;for(let a=0;a<t.length;a++)e*=t[a];if(this.data.length!==e)throw console.error("Based on the provided shape the tensor should have "+e+" values but has "+this.data.length);let a=this.data.slice();for(let e=t.length-1;e>=0;e--){let r=[],s=0;for(let i=0;i<a.length/t[e];i++){r[i]=[];for(let n=0;n<t[e];n++)r[i][n]=a[s],s++}a=r}return this.setData(a[0],t)}tile(t){if(t.length!==this.rank)throw console.error("Dimentions in reps: "+t+", does not match with the number of dimentions from tensor: "+this.shape);let e=[];for(let a=0;a<this.rank;a++)e[a]=t[a]*this.shape[a];let a=[],r=(t,a,s)=>{if(t[0]instanceof Array)for(let i=0;i<e[s];i++)a[i]=[],r(t[i%this.shape[s]],a[i],s+1);else for(let r=0;r<e[e.length-1];r++)a[r]=t[r%this.shape[this.rank-1]]};return r(this.data,a,0),this.setData(a,e)}broadcastTo(t){let e=this.shape.slice();if(t.length<this.rank)throw console.error("Rank from shape "+t.length+" is minor than tensor rank "+this.rank);if(t.length>this.rank){let e=this.shape.slice();for(;e.length<t.length;)e.unshift(1);this.reshape(e)}let a=t.slice();for(let r=0;r<t.length;r++)if(this.shape[r]===t[r])a[r]=1;else if(1!==this.shape[r])throw console.error(e+" cannot be broadcast to "+t);return this.tile(a)}broadcastArgs(t){let e=this.shape.slice(),a=t.slice();if(e.length>a.length)for(;a.length<e.length;)a.unshift(1);else for(;e.length<a.length;)e.unshift(1);let r=[];for(let t=0;t<e.length;t++)r[t]=Math.max(e[t],a[t]);return r}forEach(t){let e=a=>{if(a[0]instanceof Array)for(let t=0;t<a.length;t++)e(a[t]);else for(let e=0;e<a.length;e++)a[e]=t(a[e])};return this.data instanceof Array?e(this.data):this.data=t(this.data),this.data}forEachOfBoth(t,e){let a=(t,r)=>{if(t[0]instanceof Array)for(let e=0;e<t.length;e++)a(t[e],r[e]);else for(let a=0;a<t.length;a++)t[a]=e(t[a],r[a])};return this.data instanceof Array&&t instanceof Array?(a(this.data,t),this.data):("number"==typeof this.data&&"number"==typeof t&&(this.data=e(this.data,t)),this.data)}accesLastArray(t){let e=a=>{if(a[0]instanceof Array)for(let t=0;t<a.length;t++)e(a[t]);else t(a)};return e(this.data),this.data}accesLastArrays(t,e){let a=(t,r)=>{if(t[0]instanceof Array)for(let e=0;e<t.length;e++)a(t[e],r[e]);else e(t,r)};return a(this.data,t),this.data}static serialize(t){return JSON.stringify(t)}static deserialize(t){return"string"==typeof t&&(t=JSON.parse(t)),new n(t.data,t.shape)}}e.Tensor=n},617:function(t,e,a){var r=this&&this.__createBinding||(Object.create?function(t,e,a,r){void 0===r&&(r=a),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[a]}})}:function(t,e,a,r){void 0===r&&(r=a),t[r]=e[a]}),s=this&&this.__exportStar||function(t,e){for(var a in t)"default"===a||Object.prototype.hasOwnProperty.call(e,a)||r(e,t,a)};Object.defineProperty(e,"__esModule",{value:!0}),s(a(274),e),s(a(712),e),s(a(470),e),s(a(10),e),s(a(374),e),s(a(198),e),s(a(865),e),s(a(115),e),s(a(928),e),s(a(512),e)},805:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.randomStdNorm=e.randomNormal=e.randomRange=e.randomInt=e.map=e.constrain=void 0,e.constrain=(t,e,a)=>Math.max(Math.min(t,a),e),e.map=(t,e,a,r,s)=>(t-e)/(a-e)*(s-r)+r,e.randomInt=(t,e=1)=>"number"==typeof t?Math.floor(Math.random()*(e-t)+t):Math.floor(Math.random()*(t[1]-t[0])+t[0]),e.randomRange=(t,e=1)=>"number"==typeof t?Math.random()*(e-t)+t:Math.random()*(t[1]-t[0])+t[0],e.randomNormal=(t=0,e=1)=>{let a,r,s;do{a=2*Math.random()-1,r=2*Math.random()-1,s=a*a+r*r}while(s>=1||0==s);return e*(a*Math.sqrt(-2*Math.log(s)/s))+t},e.randomStdNorm=()=>{let t,e,a;do{t=2*Math.random()-1,e=2*Math.random()-1,a=t*t+e*e}while(a>=1||0==a);return t*Math.sqrt(-2*Math.log(a)/a)}}},e={};return function a(r){var s=e[r];if(void 0!==s)return s.exports;var i=e[r]={exports:{}};return t[r].call(i.exports,i,i.exports,a),i.exports}(607)})()}));